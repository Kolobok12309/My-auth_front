(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["group"],{"7d57":function(e,t,r){"use strict";r.r(t);r("4de4");var n=r("7a23");function a(e,t,r,a,o,c){var i=Object(n["resolveComponent"])("UserFilter"),u=Object(n["resolveComponent"])("UsersTable");return Object(n["openBlock"])(),Object(n["createBlock"])("div",null,[Object(n["createVNode"])(i,{username:e.filter.username,"onUpdate:username":t[1]||(t[1]=function(t){return e.filter.username=t}),email:e.filter.email,"onUpdate:email":t[2]||(t[2]=function(t){return e.filter.email=t}),role:e.filter.role,"onUpdate:role":t[3]||(t[3]=function(t){return e.filter.role=t}),pending:e.pending,groupId:e.filter.groupId,hideGroup:"",onSubmit:e.onFilter},null,8,["username","email","role","pending","groupId","onSubmit"]),Object(n["createVNode"])(u,{title:"Пользователи отдела",users:e.users,pending:e.pending,page:e.meta&&e.meta.page,perPage:e.meta&&e.meta.perPage,totalCount:e.meta&&e.meta.totalCount,class:"p-mt-3",onPage:e.onChangePage},null,8,["users","pending","page","perPage","totalCount","onPage"])])}var o=r("3835"),c=r("5530"),i=(r("96cf"),r("1da1")),u=r("f31b"),l=r.n(u),s=Object(n["createTextVNode"])(" Фильтр пользователей "),p={class:"p-grid"},d={class:"p-col-fixed"},m={class:"p-input-icon-left"},b=Object(n["createVNode"])("i",{class:"pi pi-search"},null,-1),f={class:"p-col-fixed"},g={class:"p-col-fixed"},j={key:0,class:"p-col-fixed"},O={class:"p-col-fixed"};function v(e,t,r,a,o,c){var i=Object(n["resolveComponent"])("InputText"),u=Object(n["resolveComponent"])("RolePicker"),l=Object(n["resolveComponent"])("GroupPicker"),v=Object(n["resolveComponent"])("Button"),h=Object(n["resolveComponent"])("Card");return Object(n["openBlock"])(),Object(n["createBlock"])(h,null,{title:Object(n["withCtx"])((function(){return[s]})),content:Object(n["withCtx"])((function(){return[Object(n["createVNode"])("form",{class:"user-filter",onSubmit:t[5]||(t[5]=Object(n["withModifiers"])((function(){return e.onSubmit&&e.onSubmit.apply(e,arguments)}),["prevent"]))},[Object(n["createVNode"])("div",p,[Object(n["createVNode"])("div",d,[Object(n["createVNode"])("span",m,[b,Object(n["createVNode"])(i,{modelValue:e.compUsername,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.compUsername=t}),disabled:e.pending,type:"text",placeholder:"Имя пользователя"},null,8,["modelValue","disabled"])])]),Object(n["createVNode"])("div",f,[Object(n["createVNode"])(i,{modelValue:e.compEmail,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.compEmail=t}),disabled:e.pending,type:"text",placeholder:"E-mail"},null,8,["modelValue","disabled"])]),Object(n["createVNode"])("div",g,[Object(n["createVNode"])(u,{modelValue:e.compRole,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.compRole=t}),disabled:e.pending,showClear:""},null,8,["modelValue","disabled"])]),e.hideGroup?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])("div",j,[Object(n["createVNode"])(l,{modelValue:e.compGroupId,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.compGroupId=t}),disabled:e.pending},null,8,["modelValue","disabled"])])),Object(n["createVNode"])("div",O,[Object(n["createVNode"])(v,{type:"submit",label:"Поиск",icon:"pi pi-search"})])])],32)]})),_:1})}r("a9e3");var h=r("a581"),k=r("a7ca"),V=r.n(k),C=r("a84a"),w=r.n(C),x=r("6549"),N=r.n(x),y=r("a871"),I=r("5c09"),B={Card:V.a,InputText:w.a,Button:N.a,GroupPicker:y["a"],RolePicker:I["a"]},S={name:"UserFilter",components:B,props:{pending:{type:Boolean,default:!1},hideGroup:{type:Boolean,default:!1},username:{type:String,default:""},email:{type:String,default:""},role:{type:Number,default:null},groupId:{type:Number,default:null}},emits:["submit","update:username","update:email","update:role","update:groupId"],computed:Object(c["a"])({},Object(h["a"])(["username","email","role","groupId"])),methods:{onSubmit:function(){this.$emit("submit")}}};S.render=v;var P=S,R=Object(n["createVNode"])("div",{class:"p-text-center"}," Пользователи не найдены ",-1),U={key:1};function T(e,t,r,a,o,c){var i=Object(n["resolveComponent"])("Column"),u=Object(n["resolveComponent"])("RoleView"),l=Object(n["resolveComponent"])("GroupView"),s=Object(n["resolveComponent"])("DataTable");return Object(n["openBlock"])(),Object(n["createBlock"])(s,{title:e.title,items:e.users,pending:e.pending,page:e.page,perPage:e.perPage,totalCount:e.totalCount,onRowSelect:e.onRowSelect},{empty:Object(n["withCtx"])((function(){return[R]})),default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(i,{field:"id",header:"#"}),Object(n["createVNode"])(i,{field:"username",header:"Имя пользователя"}),Object(n["createVNode"])(i,{field:"email",header:"E-mail"}),Object(n["createVNode"])(i,{field:"role",header:"Роль",headerClass:"p-text-center",bodyClass:"p-text-center"},{body:Object(n["withCtx"])((function(e){var t=e.data.role;return[Object(n["createVNode"])(u,{value:t},null,8,["value"])]})),_:1}),Object(n["createVNode"])(i,{field:"group",header:"Отдел",headerClass:"p-text-center",bodyClass:"p-text-center"},{body:Object(n["withCtx"])((function(e){var t=e.data.group;return[t?(Object(n["openBlock"])(),Object(n["createBlock"])(l,{key:0,group:t},null,8,["group"])):(Object(n["openBlock"])(),Object(n["createBlock"])("span",U," Не выбран "))]})),_:1})]})),_:1},8,["title","items","pending","page","perPage","totalCount","onRowSelect"])}var E=r("c524"),_=r.n(E),G=r("0dd2"),F=r("3635"),D=r("be88"),$={Column:_.a,DataTable:G["a"],RoleView:F["a"],GroupView:D["a"]},A={name:"UsersTable",components:$,props:{title:{type:String,default:"Задачи"},users:{type:Array,default:function(){return[]}},pending:{type:Boolean,default:!1},page:{type:Number,default:1},perPage:{type:Number,default:20},totalCount:{type:Number,default:0}},methods:{onRowSelect:function(e){this.$router.push("/user/".concat(e.id,"/profile"))}}};A.render=T;var H=A,M=r("c24f"),q={name:"GroupUsersPage",components:{UserFilter:P,UsersTable:H},props:{group:{type:Object,required:!0}},data:function(){return{pending:!0,users:[],meta:null,filter:{username:"",email:"",role:null,groupId:null}}},watch:{group:{handler:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.id,t.filter.groupId=n,r.next=4,t.loadUsers();case 4:case"end":return r.stop()}}),r)})))()},immediate:!0}},methods:{onFilter:function(){this.loadUsers()},onChangePage:function(e){this.loadUsers(e.page+1,e.rows)},loadUsers:function(){var e=arguments,t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a,i,u,s,p,d,m,b,f;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:1,a=e.length>1&&void 0!==e[1]?e[1]:20,i=Object(c["a"])(Object(c["a"])({},t.filter),{},{page:n,perPage:a}),t.pending=!0,r.next=6,l()(Object(M["e"])(t.$axios,i));case 6:if(u=r.sent,s=Object(o["a"])(u,2),p=s[0],d=s[1],d=void 0===d?{}:d,m=d.items,b=d.meta,f=void 0===b?null:b,!p){r.next=16;break}return t.$toast.add({severity:"error",summary:p.serverError||"Ошибка загрузки пользователей",life:5e3}),t.pending=!1,r.abrupt("return");case 16:t.users=m,t.meta=f,t.pending=!1;case 19:case"end":return r.stop()}}),r)})))()}}};q.render=a;t["default"]=q},"90ab":function(e,t,r){"use strict";r.r(t);r("b0c0");var n=r("7a23"),a=Object(n["withScopeId"])("data-v-22582550");Object(n["pushScopeId"])("data-v-22582550");var o={class:"group-page p-grid p-mx-0"},c={class:"p-col-12 p-md-4 p-xl-2 p-offset-0 p-xl-offset-2"},i={class:"p-d-flex p-ai-center"},u=Object(n["createVNode"])("span",{class:"p-mr-2"}," Информация ",-1),l={class:"p-inputgroup"},s={class:"group-page__center p-col-12 p-md-8 p-xl-6"},p={class:"group-page__center__content"};Object(n["popScopeId"])();var d=a((function(e,t,r,d,m,b){var f=Object(n["resolveComponent"])("Button"),g=Object(n["resolveComponent"])("InputText"),j=Object(n["resolveComponent"])("SkeletonHelper"),O=Object(n["resolveComponent"])("Card"),v=Object(n["resolveComponent"])("Menubar"),h=Object(n["resolveComponent"])("router-view"),k=Object(n["resolveComponent"])("SpinnerHelper");return Object(n["openBlock"])(),Object(n["createBlock"])("div",o,[Object(n["createVNode"])("div",c,[Object(n["createVNode"])(O,null,{title:a((function(){return[Object(n["createVNode"])("div",i,[u,e.isDirector||e.isAdmin?(Object(n["openBlock"])(),Object(n["createBlock"])(f,{key:0,icon:"pi pi-cog",class:"p-button-secondary p-button-sm p-button-text p-button-rounded p-ml-auto",onClick:e.toggleEdit},null,8,["onClick"])):Object(n["createCommentVNode"])("",!0)])]})),content:a((function(){return[Object(n["createVNode"])(j,{pending:e.pending},{default:a((function(){return[Object(n["withDirectives"])(Object(n["createVNode"])("form",{onSubmit:t[2]||(t[2]=Object(n["withModifiers"])((function(){return e.onSubmit&&e.onSubmit.apply(e,arguments)}),["prevent"]))},[Object(n["createVNode"])("div",l,[Object(n["createVNode"])(g,{modelValue:e.form.name,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.form.name=t}),placeholder:"Название"},null,8,["modelValue"]),Object(n["createVNode"])(f,{icon:"pi pi-search",type:"submit"})])],544),[[n["vShow"],e.isEdit]]),Object(n["withDirectives"])(Object(n["createVNode"])("span",null," Название: "+Object(n["toDisplayString"])(e.group.name),513),[[n["vShow"],!e.isEdit]])]})),_:1},8,["pending"])]})),_:1})]),Object(n["createVNode"])("div",s,[Object(n["createVNode"])(v,{model:e.toolbarItems,class:"p-mb-3"},null,8,["model"]),Object(n["createVNode"])("div",p,[Object(n["createVNode"])(k,{pending:e.pending,class:"p-mx-auto p-mt-6"},{default:a((function(){return[Object(n["createVNode"])(h,{group:e.group,pending:e.pending},{default:a((function(t){var r=t.Component;return[(Object(n["openBlock"])(),Object(n["createBlock"])(n["KeepAlive"],{max:"2"},[(Object(n["openBlock"])(),Object(n["createBlock"])(Object(n["resolveDynamicComponent"])(r),{key:e.$route.fullPath}))],1024))]})),_:1},8,["group","pending"])]})),_:1},8,["pending"])])])])})),m=(r("a9e3"),r("3835")),b=(r("96cf"),r("1da1")),f=r("5530"),g=r("f31b"),j=r.n(g),O=r("5502"),v=r("be3b"),h=r("23ba"),k=r("a7ca"),V=r.n(k),C=r("0596"),w=r.n(C),x=r("a0cd"),N=r.n(x),y=r("6549"),I=r.n(y),B=r("a84a"),S=r.n(B),P=r("08bd"),R=r("4ecd"),U={Card:V.a,Divider:w.a,Menubar:N.a,Button:I.a,InputText:S.a,SkeletonHelper:P["a"],SpinnerHelper:R["a"]},T={name:"GroupPage",components:U,props:{id:{type:Number,required:!0}},data:function(){return{group:null,pending:!0,isEdit:!1,form:{name:""}}},computed:Object(f["a"])(Object(f["a"])({},Object(O["c"])("user",["isDirector","isAdmin"])),{},{toolbarItems:function(){var e=this.id;return[{label:"Задачи",icon:"pi pi-list",to:"/group/".concat(e,"/tasks")},{label:"Участники",icon:"pi pi-users",to:"/group/".concat(e,"/users")}]}}),watch:{group:{handler:function(){this.resetForm(),this.isEdit=!1},immediate:!0},isEdit:function(e){e||this.resetForm()}},methods:{toggleEdit:function(){this.isEdit=!this.isEdit},resetForm:function(){this.form.name=this.group?this.group.name:""},onSubmit:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,j()(Object(h["c"])(e.$axios,e.id,e.form));case 2:if(r=t.sent,n=Object(m["a"])(r,2),a=n[0],o=n[1],!a){t.next=9;break}return e.$toast.add({severity:"error",summary:a.serverError||"Ошибка обновления информации об отделе",life:5e3}),t.abrupt("return");case 9:e.group=o;case 10:case"end":return t.stop()}}),t)})))()}},beforeRouteEnter:function(e,t,r){return Object(b["a"])(regeneratorRuntime.mark((function t(){var n,a,o,c,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.params.id,t.next=3,j()(Object(h["a"])(v["a"],n));case 3:if(a=t.sent,o=Object(m["a"])(a,2),c=o[0],i=o[1],!c){t.next=10;break}return console.error(c),t.abrupt("return",r(!1));case 10:r((function(e){e.group=i,e.pending=!1}));case 11:case"end":return t.stop()}}),t)})))()},beforeRouteUpdate:function(e,t,r){var n=this;return Object(b["a"])(regeneratorRuntime.mark((function a(){var o,c,i,u,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(o=e.params.id,o!==t.params.id){a.next=3;break}return a.abrupt("return",r());case 3:return n.pending=!0,a.next=6,j()(Object(h["a"])(v["a"],o));case 6:c=a.sent,i=Object(m["a"])(c,2),u=i[0],l=i[1],n.pending=!1,u?(console.error(u),r(!1)):(n.group=l,r());case 12:case"end":return a.stop()}}),a)})))()}};r("f4f3");T.render=d,T.__scopeId="data-v-22582550";t["default"]=T},"9ad1":function(e,t,r){"use strict";r.r(t);r("4de4");var n=r("7a23");function a(e,t,r,a,o,c){var i=Object(n["resolveComponent"])("TaskFilter"),u=Object(n["resolveComponent"])("TaskTable");return Object(n["openBlock"])(),Object(n["createBlock"])("div",null,[Object(n["createVNode"])(i,{title:e.filter.title,"onUpdate:title":t[1]||(t[1]=function(t){return e.filter.title=t}),status:e.filter.status,"onUpdate:status":t[2]||(t[2]=function(t){return e.filter.status=t}),userId:e.filter.userId,"onUpdate:userId":t[3]||(t[3]=function(t){return e.filter.userId=t}),pending:e.pending,groupId:e.filter.groupId,hideGroup:"",onSubmit:e.onFilter},null,8,["title","status","userId","pending","groupId","onSubmit"]),Object(n["createVNode"])(u,{title:"Задачи отдела",tasks:e.tasks,pending:e.pending,page:e.meta&&e.meta.page,perPage:e.meta&&e.meta.perPage,totalCount:e.meta&&e.meta.totalCount,class:"p-mt-3",onPage:e.onChangePage},null,8,["tasks","pending","page","perPage","totalCount","onPage"])])}var o=r("3835"),c=r("5530"),i=(r("96cf"),r("1da1")),u=r("f31b"),l=r.n(u),s=r("6925"),p=r("ca0e"),d=r("b199"),m={name:"GroupTasksPage",components:{TaskFilter:s["a"],TaskTable:p["a"]},props:{group:{type:Object,required:!0}},data:function(){return{pending:!0,tasks:[],meta:null,filter:{title:"",status:null,userId:null,groupId:null}}},watch:{group:{handler:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.id,t.filter.groupId=n,t.filter.userId=null,r.next=5,t.loadTasks();case 5:case"end":return r.stop()}}),r)})))()},immediate:!0}},methods:{onFilter:function(){this.loadTasks()},onChangePage:function(e){this.loadTasks(e.page+1,e.rows)},loadTasks:function(){var e=arguments,t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a,i,u,s,p,m,b,f,g;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:1,a=e.length>1&&void 0!==e[1]?e[1]:20,i=Object(c["a"])(Object(c["a"])({},t.filter),{},{page:n,perPage:a}),t.pending=!0,r.next=6,l()(Object(d["e"])(t.$axios,i));case 6:if(u=r.sent,s=Object(o["a"])(u,2),p=s[0],m=s[1],m=void 0===m?{}:m,b=m.items,f=m.meta,g=void 0===f?null:f,!p){r.next=16;break}return t.$toast.add({severity:"error",summary:p.serverError||"Ошибка загрузки задач",life:5e3}),t.pending=!1,r.abrupt("return");case 16:t.tasks=b,t.meta=g,t.pending=!1;case 19:case"end":return r.stop()}}),r)})))()}}};m.render=a;t["default"]=m},e7d1:function(e,t,r){},f4f3:function(e,t,r){"use strict";r("e7d1")}}]);
//# sourceMappingURL=group.e781a8d3.js.map